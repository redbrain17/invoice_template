%
% Copyright (C) 2024--2025 Marei Peischl <marei@peitex.de>
%
\DocumentMetadata{
	pdfstandard=a-3b,
	lang=de,
}
\documentclass[DIN,version=last]{scrlttr2}

\usepackage[
	format=xrechnung3.0
]{invoice}

\setkomavar{invoice}{20250804}
% \setkomavar{date}{05.05.2025}

\newkomafont{invoicetotal}{\bfseries}

\SetZUGFeRDData*{
%	document-type =  commercial-invoice, % commented as this setting matches the initial value
	id=komavar,
%	date=auto, % commented as this setting matches the initial value
%	delivery-date = auto, % commented as this setting matches the initial value
	subject=komavar,
	fromaddress=komavar,
%	tax/category=S,  % commented as this setting matches the initial value
%	tax/rate=19,  % commented as this setting matches the initial value
	unit=hour,
%	seller/vatid = {\fromvatid},
%	seller/id=1123,% If no VatID exists a seller/id is required. This might be an ID provided by the buyer
	seller/name = {\fromname\space(\fromfullname)},
	seller/postcode = {\frompostalcode},
	seller/city ={\fromcity},
	seller/country = DE,
	seller/address = {\fromstreet\space\fromstreetno},
	seller/contact = {\fromfullname\\\fromphone\\\fromemail},
	seller/email = {\fromemail},
	seller/taxid = {\fromtaxid},
	buyer/reference = {buyer-reference}, %oder Leitweg-ID
	buyer/name = {Käufer Name},
	buyer/postcode = {20253},
	buyer/city ={Hamburg},
	buyer/country = DE,
	buyer/address = {Address 1\\Address 2},
% 	buyer/vatid = {DE123456789},
	buyer/email = {invoice@example.org},
	currency=€,
	payment-terms={Zahlbar innerhalb von\space\paymentdays\space Tagen},% either this one or the due-date below is required
%	due-date={20240118},
	payment-means / type = 58, % SEPA Übereisung,
	payment-means / iban = {\fromiban},
	payment-means / account-holder = {\fromfullname},
	payment-means / bic = {\frombic},
%	tax/add-exemption-reason-auto={E={{\Additionallegalinformation}}}
}

% \InitVATExempt{E}% Intra-community supply

\usepackage{fontspec}
\setmainfont{Helvetica}

\begin{document}

\begin{letter}{Kunde\\Twietestr. 32\\20000 Hamburg}

\opening{Guten Tag,}

hiermit stelle ich Ihnen meine Arbeit im Rahmen des Projektes XX in Rechnung. Die Leistung wurde im Januar 2024 erbracht.

\AddInvoiceItem{3}{Weiterentwicklung/funktionale Erweiterung}{90}

\vspace{\baselineskip}
\PrintInvoiceTabular
\usekomavar{Additionallegalinformation}\\

Ich bitte Sie den oben genannten Betrag binnen \paymentdays{} Tagen auf unten genanntes Konto zu überweisen.

\usekomavar*{fromaccount} \tab\usekomavar{fromaccount}\\
\usekomavar*{fromiban} \tab\usekomavar{fromiban}\\
\usekomavar*{frombic} \tab\usekomavar{frombic}\\
Bank: \tab\usekomavar{frombank}\\

\usekomavar*{fromtaxid} \usekomavar{fromtaxid}\\
% \usekomavar*{fromvatid} \usekomavar{fromvatid}

\end{letter}
\end{document}
